# PLIS
## Класификация ПЛИС
### SPLD
SPLD (Simple Programmable Logic Device) простейшие програмиируемые логические дивайсы разделяются на PLA и PAL
#### PLA
PLA (Programmable Logic Arrays) - программируемые логические матрицы, состоит из матрицы вентелей И и матрицей вентелей ИЛИ. Программируется плавкими перемычками  
#### PAL
PAL (Programmable Array Logic) - программируемые матрицы логики, состоит из программируемой части И матрицы и не программируемой матрицей ИЛИ. Программируется плавкими перемычками
### CPLD
CPLD (Complex Programmable Logic Device) - комплексные программируемые логические устройства
Состоит из:
- ПМЛ подобных блоков
- Программируемой матрицы соединений
- порты ввода - вывода
- Блоки ФАПЧ
### FPGA
FPGA (Field Programmable Gate Arrays) - Программируемые пользователем вентильные матрицы  
Cостоит из:
- LUT (Look-Up Table)
- множество функциональных блоков
- система межсоединений(отличается от CPLD)
- Энергозависимая память конфигурации
## IP блоки
IP-блоки (Intellectual Property blocks) — это готовые, предварительно разработанные и верифицированные модули для ПЛИС (FPGA) и ASIC, которые можно интегрировать в проект для ускорения разработки. Они бывают аппаратными (реализованы в железе) и программными (на HDL-коде).  
Пример:
- Интерфейсы: UART, SPI, I2C, Ethernet, USB
- Память: FIFO, DDR3/4 контроллеры, RAM/ROM
- Арифметика: Целочисленные/FPU ALU, DSP-блоки (умножители, FFT)
разделяют Hard IP и Soft IP
### Hard IP
Аппаратно-зависимый блок, выпускаемый, как правило, под конкретное семейство ПЛИС, ему соответствует ASIC – структура внутри ПЛИС  
Пример:
- АЦП, ЦАП
- PLL
### Soft IP
Аппаратно-независимый блок, использование которого не зависит от конкретной ПЛИС. Применяется для построения составных частей СнК на регулярной структуре  
Пример:
- интерфейсы: UART, SPI, I2C
- FIFO
## LUT
LUT (Look-Up Table, таблица перекодировки) — это базовый элемент комбинационной логики в ПЛИС (FPGA), который реализует произвольную логическую функцию от нескольких входов.  
LUT с N входами хранит $2^N$ бит (все возможные комбинации выходов для входных значений).
## DSP-ячейки 
DSP-ячейки (Digital Signal Processing blocks) — это специализированные аппаратные блоки в ПЛИС (FPGA), предназначенные для эффективного выполнения математических операций: умножения, сложения, умножения с накоплением (MAC) и других задач цифровой обработки сигналов (ЦОС). Они существенно ускоряют вычисления по сравнению с реализацией тех же операций на обычной логике (LUT).
## Типы присваивания 
### Блокирующее присваивание (=)
Выполняется немедленно и блокирует выполнение последующих операций до своего завершения.
```verilog
always @(*) begin
    a = b + c;  // Сначала вычисляется a
    d = a << 1;  // Затем d (используется новое значение a)
end
```
Cинтезируется в комбинационную логику
### Неблокирующее присваивание (<=)
Все присваивания в блоке выполняются параллельно (правые части вычисляются одновременно, а присваивания происходят в конце временного шага).
```verilog
always_ff @(posedge clk) begin
    q1 <= d;   // Все триггеры обновляются одновременно
    q2 <= q1;  // q2 получит значение q1 до обновления
end
```
Синтезируется в D-триггеры (регистры), работающие по фронту тактового сигнала.
## Система межсоединений
![image](https://github.com/user-attachments/assets/30a2c06c-cb93-43ab-a10e-3ccf62c6a457)
- Одинарной длины – соединяют ФБ между собой или горизонтальными линиями, соединяющие переключательные блоки (ПБ)
- Двойной длины – соединяют переключательные блоки через один
- Длинные линии используются для соединения областей кристалла между собой
## ФАПЧ
ФАПЧ(фазовая автоподстройка частоты)
![image](https://github.com/user-attachments/assets/73fb5bfb-de86-4635-8bdf-e04f0ca6d0a0)  
ГУН – генератор частоты, управляемый напряжением  
Делитель 1/M – уменьшает опорную частоту, входная частота делится на M  
Делитель 1/N – уменьшает частоту петли обратной связи, выходная частота умножается на N  
Делитель 1/P – делит выходную частоту на P, опциональный и используется более тонкой настройки выходной частоты  
## Блочная память (Block RAM)
![image](https://github.com/user-attachments/assets/88b000ac-3d04-4da5-81cb-6783d1f697d4)
Распределена по всему кристалу  
Не имеет строгой организации и может быть сконфигурирована под различную разрядность данных в зависимости от задачи  
Как правило имеет двухпортовую организацию (чтение и запись)  
Может иметь внутренние схемы коррекции ошибок и конфигурируемый буфер FIFO  
Объём менее 50 Мбит даже для очень больших ПЛИС
## Блоки ввода/вывода 
![image](https://github.com/user-attachments/assets/e5cbfc37-1f7e-4ed8-9f9e-cba57eaee71c)  
Порты ввода-вывода сгруппированы в блоки дифференциальных пар, но могут работать независимо  
Блок ввода-вывода структурно разделяется на электрическую и логическую части
## JTAG интерфейс
JTAG – Joint Test Action Group – группа инженеров, задачей которых была выработка стандарта для проверки микросхем на работоспособность
![image](https://github.com/user-attachments/assets/f69b994c-fe1f-4c93-b95f-93923fe45282)
- TDI (Test Data In) — вход данных
- TDO (Test Data Out) — выход данных
- TCK (Test Clock) — тактовый сигнал
- TMS (Test Mode Select) — управление режимами
- TRST (Test Reset) — сброс.
### Метод граничного сканирования
Метод граничного сканирования обеспечивает:
- Проверка функциональной работоспособности БИС с помощью встроенных в них тестовых цепей  
- проверка качества соединений между контактами различных БИС, смонтированных на печатной плате
- считывание или установка сигналов на выходных контактах БИС в штатном режиме работы БИС
Метод граничного сканирования реализуется:
- источник тестовых команд и данных (тестовый прибор, который может являться персональным компьютером, специализированным оборудованием, микросхемой на плате, или блоком микросхемы, отвечающий за тестирование)
- механизм информационной связи тестируемых БИС и тестового прибора
- схема управления JTAG –интерфейсом в каждой проверяемой микросхеме
### Режимы работы JTAG
- Режимы самотестирования БИС, режимы записи или чтения внутрисхемных запоминающих устройств и т.д.
- Режим тестирования соединения БИС между собой
- Режим тестирования штатной работы БИС
### Структура Сканирующей ячейки
![image](https://github.com/user-attachments/assets/81e63286-ce5a-4b40-bcec-2978d4b3b6a7)
### Диограмма состояний TAP-контроллера 
![image](https://github.com/user-attachments/assets/791873b2-51cc-417c-b202-50e808846bde)
- Условие перехода между состояниями контролера – это состояние сигнала TMS (0-1)
- DR – data register
- IR – instruction register
### Системные функции JTAG
- Конфигурирование ПЛИС (в том числе загрузка в память и выбор различных конфигураций)
- Встраивание отладочных средств внутрь ПЛИС – средств самотестирования СнК или тестирования других микросхем, входящих в систему
- Внутрисхемная отладка – наблюдение состояния не только внутренних сигналов, но и состояния выводов микросхем (Tools - > Signal Tap)
### Стандарты JTAG
- BSDL — Boundary -Scan Description Language — язык описания организации и архитектуры граничного сканирования в рамках одиночной БИС
- HSDL — Hierarchical Scan Description Language (разработка фирмы Texas Instruments) — язык, ориентированный на описание информационных потоков в группе БИС, объединенных JTAG – интерфейсом - усовершенствованный язык по сравнению с BSDL – облегчает работу с интерфейсами, шинами и системами, состоящими из множества микросхем
- SVF – Serial Vector Format – упрощѐнный способ: подал тестовую последовательность (вектор), считал результат, сравнил с эталоном
### Главное JTAG 
- Необходимость поддержки этого стандарта диктуется возрастающей сложностью микросхем, печатных плат, систем и сетей на их основе
- Стандарт поддерживает гибкость тестирования за счѐт многообразия инструментов
- За время существования стандарт был дополнен различными «надстройками», отвечающими на развитие вычислительных средств, интерфейсов, сетей и т.п.
- Поддержка стандарта не требует значительных ресурсов микросхемы
- Встраивание систем самоконтроля обязательно для систем, применяемых в особо ответственных секторах (оборона, космос, телекоммуникации, медицина и т.п.)
## Системы на кристале СнК
совокупность аппаратных средств, обеспечивающих функции обмена информацией, еѐ обработки, хранения и управления этим процессом, выполненную на одном (программируемом) кристалле.
### Состав СнК
- Микропроцессор(ы)
- Память ОЗУ
- Память ПЗУ программ
- Системная шина (AMBA APB, AHB, AXI, Wishbone, OCP)
- Интерфейсы (UART, I2C, SPI, Ethernet)
- Сопроцессоры (аппаратные блоки) – ЦОС, крипто- и другие
### Система на программируемом кристале
|СБИС|          Характеристика           |ПЛИС|
|----|-----------------------------------|----|
| да |         энергозависимость         | да |
| да |     низкое энергопотребление      | да |
| нет|       перепрограммируемость       | да |
| нет| быстрый цикл разработки устройств | да |
| нет|   низкие затраты на производство  | да |
| нет| отсутствие затран на инж. образцы | да |
